# 📋 Task Manager

Консольное приложение для управления задачами с поддержкой множественных пространств (workspaces) и организацией задач по дням недели.

## 🎯 Возможности

### ✨ Основные функции
- **Управление задачами**: создание, просмотр, редактирование, удаление
- **Организация по дням**: привязка задач к конкретным дням недели
- **Множественные пространства**: разделение задач по проектам/контекстам
- **Быстрый поиск**: O(1) поиск задач по ID и названию
- **Статусы задач**: отслеживание выполнения
- **Статистика**: общий прогресс и аналитика

### 🔍 Особенности
- Интуитивный консольный интерфейс
- Автоматическое сохранение в JSON
- Подробное логирование
- Обработка ошибок
- Поддержка русского языка

## 📦 Структура проекта

```
TaskManagerApp/
│
├── app/
│   ├── models/                   # Модели данных
│   │   ├── task.py              # Модель задачи
│   │   └── workspace.py         # Модель пространства
│   │
│   ├── repositories/             # Работа с JSON
│   │   ├── base_repository.py   # Базовый репозиторий
│   │   ├── task_repository.py   # Репозиторий задач
│   │   └── workspace_repository.py
│   │
│   ├── services/                 # Бизнес-логика
│   │   ├── task_service.py      # Управление задачами
│   │   └── workspace_service.py # Управление пространствами
│   │
│   ├── ui/                       # Интерфейс
│   │   └── console_ui.py        # Консольный UI
│   │
│   ├── constants/                # Константы
│   │   ├── enums.py             # Перечисления (Day, TaskStatus)
│   │   ├── messages.py          # Сообщения
│   │   └── config.py            # Конфигурация
│   │
│   ├── exceptions/               # Исключения
│   │   └── custom_exceptions.py
│   │
│   └── utils/                    # Утилиты
│
├── data/                         # JSON файлы
│   ├── workspaces.json          # Все пространства
│   └── tasks/
│       ├── {workspace_id}.json  # Задачи каждого workspace
│
├── logs/                         # Логи приложения
│   └── app.log
│
├── main.py                       # Точка входа
├── requirements.txt              # Зависимости
└── README.md                     # Документация
```

## 🚀 Установка и запуск

### Требования
- Python 3.11+

### Установка

```bash
# 1. Клонировать репозиторий
git clone https://github.com/yourusername/TaskManagerApp.git
cd TaskManagerApp

# 2. Создать виртуальное окружение (опционально)
python -m venv venv
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows

# 3. Установить зависимости (если есть)
pip install -r requirements.txt

# 4. Запустить приложение
python main.py
```

## 📖 Использование

### Первый запуск

При первом запуске приложение предложит создать пространство задач:

```
==================================================
  Добро пожаловать в Task Manager!
==================================================

👋 Это ваш первый запуск!
У вас пока нет пространств задач.

Создать новое пространство? (да/нет): да
Введите название (Enter = 'Мои задачи'): Работа
Введите описание (Enter для пропуска): Рабочие задачи

✅ Создано пространство: Работа
```

### Главное меню

```
==================================================
  Активный workspace: [Работа]
  Задач: 5 (выполнено: 2)
==================================================

1. Управление задачами
2. Управление workspace
3. Статистика
0. Выход
```

### Управление задачами

**Добавление задачи:**
1. Выбрать "Управление задачами" → "Добавить задачу"
2. Выбрать день недели
3. Ввести название и описание

**Просмотр задач:**
- Все задачи сразу
- Задачи на конкретный день

**Поиск задачи:**
- По названию (O(1))
- По ID

**Отметка выполненной:**
- Поиск по ID или названию
- Автоматическое обновление статуса

### Управление пространствами

**Создание workspace:**
```
Введите название: Личное
Введите описание: Личные задачи
✅ Workspace создан: Личное
```

**Переключение:**
```
Доступные workspace:
1. ● Работа
2. ○ Личное

Выберите номер: 2
✅ Переключено на: Личное
```

**Удаление:**
- Защита от удаления последнего workspace
- Подтверждение операции
- Удаление всех задач workspace

## 🏗️ Архитектура

### Слоистая архитектура

```
┌─────────────────────────────────────┐
│            UI Layer                 │  ← Консольный интерфейс
│         (ConsoleUI)                 │
└─────────────────────────────────────┘
                 ↓
┌─────────────────────────────────────┐
│         Service Layer               │  ← Бизнес-логика
│  (TaskService, WorkspaceService)    │
└─────────────────────────────────────┘
                 ↓
┌─────────────────────────────────────┐
│       Repository Layer              │  ← Работа с данными
│ (TaskRepository, WorkspaceRepository)│
└─────────────────────────────────────┘
                 ↓
┌─────────────────────────────────────┐
│          Data Layer                 │  ← JSON файлы
│     (workspaces.json, tasks/)       │
└─────────────────────────────────────┘
```

### Принципы проектирования

- **Single Responsibility** - каждый класс имеет одну ответственность
- **Dependency Injection** - зависимости передаются через конструктор
- **Repository Pattern** - абстракция работы с данными
- **Service Layer** - централизация бизнес-логики
- **Clean Architecture** - разделение на слои

## 🔧 Технические детали

### Индексация задач

TaskService использует два индекса для быстрого поиска:

```python
_task_by_id: Dict[str, Task]           # O(1) поиск по ID
_task_by_name: Dict[str, List[str]]    # O(1) поиск по имени
```

Индексы строятся при загрузке workspace и обновляются автоматически при любых изменениях.

### Хранение данных

**Формат workspaces.json:**
```json
[
  {
    "id": "uuid-string",
    "name": "Работа",
    "is_active": true,
    "created_at": "2025-01-20T10:00:00",
    "updated_at": null
  }
]
```

**Формат tasks/{workspace_id}.json:**
```json
{
  "понедельник": [
    {
      "id": "task-uuid",
      "title": "Митинг",
      "description": "Встреча с командой",
      "status": "не выполнено",
      "created_at": "2025-01-20T10:00:00",
      "updated_at": null,
      "completed_at": null
    }
  ],
  "вторник": []
}
```

### Логирование

Логи сохраняются в `logs/app.log`:
- **Уровень файла**: INFO и выше
- **Уровень консоли**: WARNING и выше
- **Формат**: `%(asctime)s - %(name)s - %(levelname)s - %(message)s`

## 🎨 Расширение функциональности

### Добавление новых функций

1. **Приоритеты задач** - уже есть `Priority` enum в `constants/enums.py`
2. **Теги** - добавить модель `Tag` и связь many-to-many
3. **Напоминания** - добавить модель `Reminder` с временем
4. **Экспорт/Импорт** - добавить методы в Repository

### Добавление GUI

Благодаря слоистой архитектуре, можно легко добавить GUI:

```python
# app/ui/gui_ui.py
from tkinter import Tk
from app.services.task_service import TaskService
from app.services.workspace_service import WorkspaceService

class GUI:
    def __init__(self, task_service, workspace_service):
        self.task_service = task_service
        self.workspace_service = workspace_service
        # ... GUI код
```

### Замена JSON на SQLite

Создать новые репозитории:

```python
# app/repositories/sqlite_task_repository.py
from app.repositories.base_repository import BaseRepository

class SQLiteTaskRepository(BaseRepository):
    # Реализация с SQLite
    pass
```

Сервисы и UI остаются без изменений!

## 🧪 Тестирование

```bash
# Запуск тестов (когда будут добавлены)
python -m pytest tests/

# Покрытие кода
python -m pytest --cov=app tests/
```

## 📝 TODO

- [ ] Добавить unit тесты
- [ ] Реализовать приоритеты задач
- [ ] Добавить фильтрацию по статусу
- [ ] Реализовать экспорт в CSV/PDF
- [ ] Добавить напоминания
- [ ] Создать GUI версию
- [ ] Добавить поддержку тем оформления
- [ ] Реализовать синхронизацию между устройствами
